# Project Sol: å‹•ä½œç¢ºèªã‚¬ã‚¤ãƒ‰

## ðŸ“‹ å•é¡Œç‚¹ã®ç¢ºèª

ç”Ÿæˆã•ã‚ŒãŸå•é¡Œã«ã¯ä»¥ä¸‹ã®è­¦å‘Šã‚„ã‚¨ãƒ©ãƒ¼ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

### âš ï¸ è­¦å‘Šï¼ˆå‹•ä½œã«ã¯å½±éŸ¿ã—ãªã„ãŒæ”¹å–„æŽ¨å¥¨ï¼‰

1. **Flag placement validation issues**
   - ãƒ•ãƒ©ã‚°ã®é…ç½®ãŒæ¨™æº–ã«åˆã£ã¦ã„ãªã„
   - ä¾‹: RCEå•é¡Œãªã®ã«`/flag.txt`ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ï¼ˆ`/home/ctfuser/flag.txt`ã§ã‚ã‚‹ã¹ãï¼‰
   - **å½±éŸ¿**: å•é¡Œã¯å‹•ä½œã™ã‚‹ãŒã€æ¨™æº–ã«æº–æ‹ ã—ã¦ã„ãªã„

### âŒ ã‚¨ãƒ©ãƒ¼ï¼ˆå‹•ä½œã«å½±éŸ¿ã™ã‚‹ï¼‰

1. **Failed to start test container**
   - ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã«å¤±æ•—ã—ã¦ã„ã‚‹
   - **å½±éŸ¿**: å•é¡ŒãŒå®Ÿéš›ã«å‹•ä½œã™ã‚‹ã‹ç¢ºèªã§ããªã„

2. **Mission marked as potentially unsolvable**
   - å•é¡ŒãŒè§£ã‘ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹ã¨ãƒžãƒ¼ã‚¯ã•ã‚Œã¦ã„ã‚‹
   - **å½±éŸ¿**: ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ã•ã‚Œã‚‹ãŒã€å®Ÿéš›ã«ã¯è§£ã‘ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹

---

## ðŸ” å‹•ä½œç¢ºèªæ‰‹é †

### Step 1: ç”Ÿæˆã•ã‚ŒãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

```bash
python3 -c "
import json
with open('challenges/drafts/SOL-MSN-0YWJ.json', 'r') as f:
    data = json.load(f)
    print('Type:', data.get('type'))
    print('Flag:', data.get('flag_answer'))
    dockerfile = data.get('files', {}).get('Dockerfile', '')
    if '/home/ctfuser/flag.txt' in dockerfile:
        print('âœ“ Flag placement: CORRECT')
    else:
        print('âœ— Flag placement: WRONG')
        if '/flag.txt' in dockerfile:
            print('  Found: /flag.txt (should be /home/ctfuser/flag.txt for RCE)')
"
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… å•é¡Œã‚¿ã‚¤ãƒ—ï¼ˆRCE/SQLiç­‰ï¼‰ãŒæ­£ã—ã„ã‹
- âœ… ãƒ•ãƒ©ã‚°ãŒæ­£ã—ã„å½¢å¼ï¼ˆ`SolCTF{...}`ï¼‰ã‹
- âœ… ãƒ•ãƒ©ã‚°ã®é…ç½®ãŒå•é¡Œã‚¿ã‚¤ãƒ—ã«åˆã£ã¦ã„ã‚‹ã‹

### Step 2: Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ç¢ºèª

```bash
docker images | grep sol/mission-0ywj
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ­£å¸¸ã«ãƒ“ãƒ«ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹
- âœ… ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºãŒé©åˆ‡ã‹ï¼ˆç•°å¸¸ã«å¤§ãã„å ´åˆã¯å•é¡Œã®å¯èƒ½æ€§ï¼‰

### Step 3: ã‚³ãƒ³ãƒ†ãƒŠã®æ‰‹å‹•èµ·å‹•ãƒ†ã‚¹ãƒˆ

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•
docker run -d -p 8000:8000 --name test-0ywj sol/mission-0ywj:latest

# èµ·å‹•ç¢ºèª
sleep 3
docker ps | grep test-0ywj

# ãƒ­ã‚°ã‚’ç¢ºèª
docker logs test-0ywj
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ã‚³ãƒ³ãƒ†ãƒŠãŒæ­£å¸¸ã«èµ·å‹•ã—ã¦ã„ã‚‹ã‹
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãªã„ã‹
- âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒãƒ¼ãƒˆ8000ã§ãƒªãƒƒã‚¹ãƒ³ã—ã¦ã„ã‚‹ã‹

**ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆ:**
```bash
# è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
docker logs test-0ywj 2>&1 | tail -50
```

### Step 4: ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ãƒ•ãƒ©ã‚°ã®ç¢ºèª

```bash
# RCEå•é¡Œã®å ´åˆï¼ˆ/home/ctfuser/flag.txtï¼‰
docker exec test-0ywj cat /home/ctfuser/flag.txt

# Webå•é¡Œã®å ´åˆï¼ˆ/flag.txtï¼‰
docker exec test-0ywj cat /flag.txt

# ç’°å¢ƒå¤‰æ•°ã«ãƒ•ãƒ©ã‚°ãŒã‚ã‚‹å ´åˆ
docker exec test-0ywj env | grep FLAG
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ãƒ•ãƒ©ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Ÿéš›ã«å­˜åœ¨ã™ã‚‹ã‹
- âœ… ãƒ•ãƒ©ã‚°ã®å†…å®¹ãŒæ­£ã—ã„ã‹ï¼ˆ`SolCTF{...}`å½¢å¼ï¼‰
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ãŒé©åˆ‡ã‹ï¼ˆ`ctfuser`ãŒèª­ã¿å–ã‚Šå¯èƒ½ï¼‰

### Step 5: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•ä½œç¢ºèª

```bash
# HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ç¢ºèª
curl http://localhost:8000

# ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:8000 ã«ã‚¢ã‚¯ã‚»ã‚¹
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:**
- âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«å¿œç­”ã™ã‚‹ã‹
- âœ… ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã‹
- âœ… åŸºæœ¬çš„ãªæ©Ÿèƒ½ãŒå‹•ä½œã—ã¦ã„ã‚‹ã‹

### Step 6: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```bash
docker stop test-0ywj
docker rm test-0ywj
```

---

## ðŸ› ï¸ å•é¡ŒãŒç™ºè¦‹ã•ã‚ŒãŸå ´åˆã®å¯¾å‡¦æ³•

### å•é¡Œ1: ãƒ•ãƒ©ã‚°é…ç½®ãŒé–“é•ã£ã¦ã„ã‚‹

**ç—‡çŠ¶:**
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§è­¦å‘ŠãŒå‡ºã‚‹
- ãƒ•ãƒ©ã‚°ãŒæœŸå¾…ã•ã‚Œã‚‹å ´æ‰€ã«ãªã„

**å¯¾å‡¦æ³•:**
1. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ”¹å–„ã—ã¦å†ç”Ÿæˆ
2. ã¾ãŸã¯ã€ç”Ÿæˆã•ã‚ŒãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰‹å‹•ã§ä¿®æ­£

```bash
# JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
vim challenges/drafts/SOL-MSN-0YWJ.json

# Dockerfileã®ãƒ•ãƒ©ã‚°é…ç½®ã‚’ä¿®æ­£
# /flag.txt â†’ /home/ctfuser/flag.txt (RCEå•é¡Œã®å ´åˆ)
```

### å•é¡Œ2: ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ãªã„

**ç—‡çŠ¶:**
- `Failed to start test container`ã‚¨ãƒ©ãƒ¼
- `docker run`ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

**å¯¾å‡¦æ³•:**
1. ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦åŽŸå› ã‚’ç‰¹å®š
2. ãƒãƒ¼ãƒˆç«¶åˆã®å¯èƒ½æ€§ã‚’ç¢ºèª
3. Dockerfileã«å•é¡ŒãŒãªã„ã‹ç¢ºèª

```bash
# ãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­ã‹ç¢ºèª
netstat -tuln | grep 8000

# åˆ¥ã®ãƒãƒ¼ãƒˆã§è©¦ã™
docker run -d -p 8001:8000 --name test-0ywj sol/mission-0ywj:latest
```

### å•é¡Œ3: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã—ãªã„

**ç—‡çŠ¶:**
- ã‚³ãƒ³ãƒ†ãƒŠã¯èµ·å‹•ã™ã‚‹ãŒã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹
- ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

**å¯¾å‡¦æ³•:**
1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ã‚’ç¢ºèª
2. `app.py`ã®ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
3. å¿…è¦ãªä¾å­˜é–¢ä¿‚ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

```bash
# ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ‰‹å‹•å®Ÿè¡Œ
docker exec -it test-0ywj /bin/sh
python app.py
```

---

## âœ… æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹å ´åˆã®ç¢ºèªé …ç›®

ä»¥ä¸‹ã®ã™ã¹ã¦ãŒç¢ºèªã§ãã‚Œã°ã€å•é¡Œã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ï¼š

- [ ] JSONãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ­£å¸¸ã«ãƒ“ãƒ«ãƒ‰ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚³ãƒ³ãƒ†ãƒŠãŒæ­£å¸¸ã«èµ·å‹•ã™ã‚‹
- [ ] ãƒ•ãƒ©ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„å ´æ‰€ã«å­˜åœ¨ã™ã‚‹
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒHTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿œç­”ã™ã‚‹
- [ ] åŸºæœ¬çš„ãªæ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹

---

## ðŸ“ æ³¨æ„äº‹é …

- **è­¦å‘Šã¯å‹•ä½œã«å½±éŸ¿ã—ãªã„**: è­¦å‘ŠãŒå‡ºã¦ã‚‚ã€å•é¡Œã¯å‹•ä½œã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
- **ã‚¨ãƒ©ãƒ¼ã¯å‹•ä½œã«å½±éŸ¿ã™ã‚‹**: ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸå ´åˆã¯ã€åŽŸå› ã‚’èª¿æŸ»ã—ã¦ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- **æ‰‹å‹•ç¢ºèªã‚’æŽ¨å¥¨**: è‡ªå‹•ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¦ã‚‚ã€æ‰‹å‹•ã§ç¢ºèªã™ã‚‹ã¨å‹•ä½œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™

---

## ðŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒãƒ¼ãƒˆç«¶åˆã‚¨ãƒ©ãƒ¼

```bash
# ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’ç¢ºèª
netstat -tuln | grep 8000

# åˆ¥ã®ãƒãƒ¼ãƒˆã‚’ä½¿ç”¨
docker run -d -p 8001:8000 --name test-0ywj sol/mission-0ywj:latest
```

### ã‚³ãƒ³ãƒ†ãƒŠãŒã™ãã«åœæ­¢ã™ã‚‹

```bash
# ãƒ­ã‚°ã‚’ç¢ºèª
docker logs test-0ywj

# ã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã£ã¦ç¢ºèª
docker exec -it test-0ywj /bin/sh
```

### ãƒ•ãƒ©ã‚°ãŒè¦‹ã¤ã‹ã‚‰ãªã„

```bash
# ã™ã¹ã¦ã®å ´æ‰€ã‚’ç¢ºèª
docker exec test-0ywj find / -name "flag.txt" 2>/dev/null
docker exec test-0ywj env | grep -i flag
```

