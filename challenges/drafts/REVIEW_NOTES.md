# CTF問題レビューノート

このファイルは、生成されたCTF問題の品質管理とレビュー状況を記録するためのものです。

## レビューワークフロー

```
Draft → Review → Test → Approve/Reject → Deploy
```

---

## レビューチェックリスト

各問題をレビューする際は、以下の項目を確認してください。

### ✅ 技術的チェック

- [ ] コンテナが正常に起動する
- [ ] フラグファイルが存在する（正しいパスに配置されている）
- [ ] 脆弱性が実際に動作する
- [ ] 意図した方法でフラグが取得できる
- [ ] 意図しないエンドポイントがない（`/flag`, `/debug`, `/admin`等）
- [ ] セキュリティ設定が不適切でない（例: `shell=False` for コマンドインジェクション問題）
- [ ] `capture_output=True` などで出力が隠されていない

### ✅ 品質チェック

- [ ] 問題文が分かりやすい
- [ ] 難易度が適切（実際に解いてみて）
- [ ] ヒントが適切（多すぎず少なすぎず）
- [ ] Writeup（解説）が正確で詳細
- [ ] ストーリー性がある
- [ ] 禁止用語が使用されていない

### ✅ セキュリティチェック

- [ ] リソース制限が設定されている（CPU, Memory, PIDs）
- [ ] 非rootユーザーで実行される
- [ ] 意図しない情報漏洩がない
- [ ] DoS攻撃の可能性がない
- [ ] ネットワーク分離が適切

### ✅ ユーザビリティチェック

- [ ] 実際に自分で解いてみた
- [ ] 所要時間が適切（30-60分程度）
- [ ] 他の問題と重複していない
- [ ] 初心者にも理解できる（難易度1-2の場合）

---

## レビュー記録

### フォーマット

```markdown
## [Mission ID] タイトル

- **レビュー日**: YYYY-MM-DD
- **レビュアー**: Your Name
- **難易度**: X/5
- **テスト所要時間**: XX分
- **ステータス**: Draft / Review / Approved / Rejected / Active
- **問題タイプ**: RCE / SQLi / SSRF / etc.

### テスト結果

- ✅ コンテナ起動: 成功
- ✅ フラグ取得: 成功
- ❌ 意図しないエンドポイント: `/flag` が露出

### 発見された問題

1. `shell=False` が設定されており、コマンドインジェクションが動作しない
2. `/flag` エンドポイントが意図せず露出している
3. Writeup内のURLが `localhost` のまま

### 判定

- [ ] ✅ 承認（Approved）
- [x] ❌ 却下（Rejected）
- [ ] 🔄 要修正（Needs Revision）

### コメント

コメントインジェクション問題として生成されたが、`shell=False`により脆弱性が動作しない。
また、`/flag` エンドポイントが露出しており、意図しない解法が可能。
**判定: 却下**

---
```

---

## レビュー履歴

### 2025-12-04

---

## [SOL-MSN-XXXX] ログ記録システム

- **レビュー日**: 2025-12-04
- **レビュアー**: Project Owner
- **難易度**: 2/5（設定値）
- **テスト所要時間**: 5分
- **ステータス**: Rejected
- **問題タイプ**: RCE

### テスト結果

- ✅ コンテナ起動: 成功
- ✅ フラグファイル存在: `/home/ctfuser/flag.txt`
- ❌ コマンドインジェクション: **動作しない**（`shell=False`）
- ❌ 意図しないエンドポイント: `/flag` が露出

### 発見された問題

1. `subprocess.run()` で `shell=False` が設定されており、コマンドインジェクションが不可能
2. `capture_output=True` により、`echo` の出力も見えない
3. `/flag` エンドポイントが露出しており、直接アクセスで取得可能
4. コメントと実装が矛盾している

### 判定

- [ ] ✅ 承認（Approved）
- [x] ❌ 却下（Rejected）
- [ ] 🔄 要修正（Needs Revision）

### コメント

コマンドインジェクション問題として生成されたが、セキュアな実装により脆弱性が存在しない。
意図しない `/flag` エンドポイントにより、簡単に解けてしまう。
AI生成の品質問題として、削除して再生成が必要。

---

## 統計

- **Total Reviewed**: 1
- **Approved**: 0
- **Rejected**: 1
- **Needs Revision**: 0
- **Approval Rate**: 0%

---

## 改善提案

### AI生成の品質向上

1. **System Promptの改善**
   - `/flag` などのデバッグエンドポイントの禁止を明示
   - `shell=False` の使用禁止（コマンドインジェクション問題の場合）
   - `capture_output=True` の使用注意

2. **自動検証の強化**
   - 意図しないエンドポイントの検出
   - 脆弱性が実際に動作するかのテスト
   - セキュアな設定の検出（アンチパターン）

3. **レビュープロセスの確立**
   - Draft生成後、必ず人間がレビュー
   - チェックリストの徹底
   - 承認されたもののみデプロイ

---

**Last Updated**: 2025-12-04

